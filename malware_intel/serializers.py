from rest_framework import serializers

from .models import MalwareIndicator


class MalwareQuerySerializer(serializers.Serializer):
    """
    Serializer for the incoming query for any indicator type.
    """

    query = serializers.CharField(
        max_length=2048, help_text="The indicator to query (URL, host, or hash)."
    )


class MalwareIndicatorSerializer(serializers.ModelSerializer):
    """
    Serializer for the response, showing the indicator and its raw data.
    """

    class Meta:
        model = MalwareIndicator
        fields = [
            "id",
            "value",
            "type",
            "last_queried",
            "raw_data",
        ]
