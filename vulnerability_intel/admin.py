from django.contrib import admin

from .models import Vulnerability, VulnerabilityReference, VulnerabilitySourceData


class VulnerabilityReferenceInline(admin.TabularInline):
    model = VulnerabilityReference
    extra = 0


class VulnerabilitySourceDataInline(admin.TabularInline):
    model = VulnerabilitySourceData
    extra = 0
    readonly_fields = ("source", "fetched_at", "raw_data")


@admin.register(Vulnerability)
class VulnerabilityAdmin(admin.ModelAdmin):
    list_display = ("id", "cvss_v3_score", "last_updated")
    search_fields = ("id", "description")
    readonly_fields = ("id", "created_at", "last_updated")
    inlines = [VulnerabilityReferenceInline, VulnerabilitySourceDataInline]
