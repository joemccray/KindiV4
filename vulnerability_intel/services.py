from .models import Vulnerability
from .tasks import task_get_vulnerability_intel


def get_vulnerability_intel(cve_id: str) -> Vulnerability:
    """
    Triggers an asynchronous task to retrieve intelligence for a given CVE.
    Returns the existing or newly created Vulnerability object immediately.
    """
    vuln, _ = Vulnerability.objects.get_or_create(id=cve_id)
    task_get_vulnerability_intel.delay(cve_id)
    return vuln
