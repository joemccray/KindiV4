from rest_framework import serializers

from .models import Vulnerability, VulnerabilityReference, VulnerabilitySourceData


class VulnerabilityReferenceSerializer(serializers.ModelSerializer):
    class Meta:
        model = VulnerabilityReference
        fields = ["url"]


class VulnerabilitySourceDataSerializer(serializers.ModelSerializer):
    class Meta:
        model = VulnerabilitySourceData
        fields = ["source", "raw_data", "fetched_at"]


class VulnerabilitySerializer(serializers.ModelSerializer):
    references = VulnerabilityReferenceSerializer(many=True, read_only=True)
    source_data = VulnerabilitySourceDataSerializer(many=True, read_only=True)

    class Meta:
        model = Vulnerability
        fields = [
            "id",
            "description",
            "cvss_v3_score",
            "cvss_v3_vector",
            "last_updated",
            "references",
            "source_data",
        ]
